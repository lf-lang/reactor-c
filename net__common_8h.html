<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>reactor-c: /Users/runner/work/reactor-c/reactor-c/include/core/federated/network/net_common.h File Reference</title>
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">reactor-c<span id="projectnumber">&#160;1.0</span>
   </div>
   <div id="projectbrief">C Runtime for Lingua Franca</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('net__common_8h.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">net_common.h File Reference<div class="ingroups"><a class="el" href="group__Federated.html">Federated</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Common message types and definitions for federated Lingua Franca programs.  
<a href="#details">More...</a></p>

<p><a href="net__common_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-define-members" class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga8ce563da4edbe9c4f7c1ccf35ad8694f" id="r_ga8ce563da4edbe9c4f7c1ccf35ad8694f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#ga8ce563da4edbe9c4f7c1ccf35ad8694f">ADDRESS_QUERY_RETRY_INTERVAL</a>&#160;&#160;&#160;<a class="el" href="group__Constants.html#ga673a8ebab8ec621a1cf731871dd170c8">MSEC</a>(250)</td></tr>
<tr class="memdesc:ga8ce563da4edbe9c4f7c1ccf35ad8694f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Time that a federate waits before asking the RTI again for the port and IP address of a federate.  <br /></td></tr>
<tr class="memitem:ga4b8c713b515dba0c86d9205dc0caf4ed" id="r_ga4b8c713b515dba0c86d9205dc0caf4ed"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#ga4b8c713b515dba0c86d9205dc0caf4ed">DELAY_START</a>&#160;&#160;&#160;<a class="el" href="group__Constants.html#ga30e47c4dd44d168c2982d3ec1d4e0825">SEC</a>(1)</td></tr>
<tr class="memdesc:ga4b8c713b515dba0c86d9205dc0caf4ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delay the start of all federates by this amount.  <br /></td></tr>
<tr class="memitem:ga8086398bfefdc0104767df037e59daa5" id="r_ga8086398bfefdc0104767df037e59daa5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#ga8086398bfefdc0104767df037e59daa5">ENCODE_STOP_GRANTED</a>(buffer,  time,  microstep)</td></tr>
<tr class="memdesc:ga8086398bfefdc0104767df037e59daa5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encode a stop granted message.  <br /></td></tr>
<tr class="memitem:ga3268a658c2cb5126be5284a86ad9bd62" id="r_ga3268a658c2cb5126be5284a86ad9bd62"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#ga3268a658c2cb5126be5284a86ad9bd62">ENCODE_STOP_REQUEST</a>(buffer,  time,  microstep)</td></tr>
<tr class="memdesc:ga3268a658c2cb5126be5284a86ad9bd62"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encode a stop request message.  <br /></td></tr>
<tr class="memitem:gae06b33f7fcdc71f52eb0fcf81e07e4d6" id="r_gae06b33f7fcdc71f52eb0fcf81e07e4d6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#gae06b33f7fcdc71f52eb0fcf81e07e4d6">ENCODE_STOP_REQUEST_REPLY</a>(buffer,  time,  microstep)</td></tr>
<tr class="memdesc:gae06b33f7fcdc71f52eb0fcf81e07e4d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encode a stop request reply message.  <br /></td></tr>
<tr class="memitem:gacc95612e1d2dbbdf34afe76d50e75223" id="r_gacc95612e1d2dbbdf34afe76d50e75223"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#gacc95612e1d2dbbdf34afe76d50e75223">FED_COM_BUFFER_SIZE</a>&#160;&#160;&#160;256u</td></tr>
<tr class="memdesc:gacc95612e1d2dbbdf34afe76d50e75223"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size of the buffer used for messages sent between federates.  <br /></td></tr>
<tr class="memitem:gae3bd830cd17cf0914b61d0516360abc1" id="r_gae3bd830cd17cf0914b61d0516360abc1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#gae3bd830cd17cf0914b61d0516360abc1">FEDERATE_ID_IN_USE</a>&#160;&#160;&#160;2</td></tr>
<tr class="memdesc:gae3bd830cd17cf0914b61d0516360abc1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Code sent with a <a class="el" href="group__Federated.html#ga59a69d0685fdc2a216718f1efa083c4c">MSG_TYPE_REJECT</a> message indicating that the federate ID is already in use.  <br /></td></tr>
<tr class="memitem:ga5846fdcf4c92041f543b73e29e78aa21" id="r_ga5846fdcf4c92041f543b73e29e78aa21"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#ga5846fdcf4c92041f543b73e29e78aa21">FEDERATE_ID_OUT_OF_RANGE</a>&#160;&#160;&#160;3</td></tr>
<tr class="memdesc:ga5846fdcf4c92041f543b73e29e78aa21"><td class="mdescLeft">&#160;</td><td class="mdescRight">Code sent with a <a class="el" href="group__Federated.html#ga59a69d0685fdc2a216718f1efa083c4c">MSG_TYPE_REJECT</a> message indicating that the federate ID is out of range.  <br /></td></tr>
<tr class="memitem:ga653676d1f302fe08249af3dee78fa294" id="r_ga653676d1f302fe08249af3dee78fa294"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#ga653676d1f302fe08249af3dee78fa294">FEDERATION_ID_DOES_NOT_MATCH</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:ga653676d1f302fe08249af3dee78fa294"><td class="mdescLeft">&#160;</td><td class="mdescRight">Code sent with a <a class="el" href="group__Federated.html#ga59a69d0685fdc2a216718f1efa083c4c">MSG_TYPE_REJECT</a> message indicating that the federation ID does not match.  <br /></td></tr>
<tr class="memitem:ga51d08a784b4ee6463688a971d99d2944" id="r_ga51d08a784b4ee6463688a971d99d2944"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#ga51d08a784b4ee6463688a971d99d2944">HMAC_DOES_NOT_MATCH</a>&#160;&#160;&#160;6</td></tr>
<tr class="memdesc:ga51d08a784b4ee6463688a971d99d2944"><td class="mdescLeft">&#160;</td><td class="mdescRight">Code sent with a <a class="el" href="group__Federated.html#ga59a69d0685fdc2a216718f1efa083c4c">MSG_TYPE_REJECT</a> message indicating that the HMAC authentication failed.  <br /></td></tr>
<tr class="memitem:gad94567b2d2e277ddc1be0da9a92b09e7" id="r_gad94567b2d2e277ddc1be0da9a92b09e7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#gad94567b2d2e277ddc1be0da9a92b09e7">MSG_TYPE_ACK</a>&#160;&#160;&#160;255</td></tr>
<tr class="memdesc:gad94567b2d2e277ddc1be0da9a92b09e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Byte identifying an acknowledgment of the previously received message.  <br /></td></tr>
<tr class="memitem:gae004cb4e5add42afe5483f6706e11d35" id="r_gae004cb4e5add42afe5483f6706e11d35"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#gae004cb4e5add42afe5483f6706e11d35">MSG_TYPE_ADDRESS_ADVERTISEMENT</a>&#160;&#160;&#160;15</td></tr>
<tr class="memdesc:gae004cb4e5add42afe5483f6706e11d35"><td class="mdescLeft">&#160;</td><td class="mdescRight">Byte identifying a message advertising the port for the TCP connection server of a federate.  <br /></td></tr>
<tr class="memitem:ga5ac191bca25da16eca3e4f02d21172ef" id="r_ga5ac191bca25da16eca3e4f02d21172ef"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#ga5ac191bca25da16eca3e4f02d21172ef">MSG_TYPE_ADDRESS_QUERY</a>&#160;&#160;&#160;13</td></tr>
<tr class="memdesc:ga5ac191bca25da16eca3e4f02d21172ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Byte identifying a address query message, sent by a federate to RTI to ask for another federate's address and port number.  <br /></td></tr>
<tr class="memitem:gaabe4cac3ef1d0834a99fa2532dfaa6ba" id="r_gaabe4cac3ef1d0834a99fa2532dfaa6ba"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#gaabe4cac3ef1d0834a99fa2532dfaa6ba">MSG_TYPE_ADDRESS_QUERY_REPLY</a>&#160;&#160;&#160;14</td></tr>
<tr class="memdesc:gaabe4cac3ef1d0834a99fa2532dfaa6ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Byte identifying a address query message reply, sent by a RTI to a federate to reply with a remote federate's address and port number.  <br /></td></tr>
<tr class="memitem:gaa13eface5080ad75bbd53abe919c80b6" id="r_gaa13eface5080ad75bbd53abe919c80b6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#gaa13eface5080ad75bbd53abe919c80b6">MSG_TYPE_CLOCK_SYNC_CODED_PROBE</a>&#160;&#160;&#160;22</td></tr>
<tr class="memdesc:gaa13eface5080ad75bbd53abe919c80b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Coded probe message.  <br /></td></tr>
<tr class="memitem:gaea37eff76ade1b2781a7e6298afb3a04" id="r_gaea37eff76ade1b2781a7e6298afb3a04"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#gaea37eff76ade1b2781a7e6298afb3a04">MSG_TYPE_CLOCK_SYNC_T1</a>&#160;&#160;&#160;19</td></tr>
<tr class="memdesc:gaea37eff76ade1b2781a7e6298afb3a04"><td class="mdescLeft">&#160;</td><td class="mdescRight">Physical clock synchronization messages according to PTP.  <br /></td></tr>
<tr class="memitem:ga52a76e4cc36217a169f32d5adde590cc" id="r_ga52a76e4cc36217a169f32d5adde590cc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#ga52a76e4cc36217a169f32d5adde590cc">MSG_TYPE_CLOCK_SYNC_T3</a>&#160;&#160;&#160;20</td></tr>
<tr class="memdesc:ga52a76e4cc36217a169f32d5adde590cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prompt the master to send a T4.  <br /></td></tr>
<tr class="memitem:gae128056ab2af39988103856ee815d930" id="r_gae128056ab2af39988103856ee815d930"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#gae128056ab2af39988103856ee815d930">MSG_TYPE_CLOCK_SYNC_T4</a>&#160;&#160;&#160;21</td></tr>
<tr class="memdesc:gae128056ab2af39988103856ee815d930"><td class="mdescLeft">&#160;</td><td class="mdescRight">Physical clock synchronization message according to PTP.  <br /></td></tr>
<tr class="memitem:gafb060091e032562cf32c0eb62340d309" id="r_gafb060091e032562cf32c0eb62340d309"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#gafb060091e032562cf32c0eb62340d309">MSG_TYPE_DOWNSTREAM_NEXT_EVENT_TAG</a>&#160;&#160;&#160;26</td></tr>
<tr class="memdesc:gafb060091e032562cf32c0eb62340d309"><td class="mdescLeft">&#160;</td><td class="mdescRight">Byte identifying a downstream next event tag (DNET) message sent from the RTI in centralized coordination.  <br /></td></tr>
<tr class="memitem:gaf27674f627be1c469a529a995da5c074" id="r_gaf27674f627be1c469a529a995da5c074"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#gaf27674f627be1c469a529a995da5c074">MSG_TYPE_FAILED</a>&#160;&#160;&#160;25</td></tr>
<tr class="memdesc:gaf27674f627be1c469a529a995da5c074"><td class="mdescLeft">&#160;</td><td class="mdescRight">Byte identifying that the federate or the RTI has failed.  <br /></td></tr>
<tr class="memitem:ga8e49ce0b1c3a58c881849ca4d0bae824" id="r_ga8e49ce0b1c3a58c881849ca4d0bae824"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#ga8e49ce0b1c3a58c881849ca4d0bae824">MSG_TYPE_FED_IDS</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:ga8e49ce0b1c3a58c881849ca4d0bae824"><td class="mdescLeft">&#160;</td><td class="mdescRight">Byte identifying a message from a federate to an RTI containing the federation ID and the federate ID.  <br /></td></tr>
<tr class="memitem:ga191b27bec42ab0370248fbc64cc9b860" id="r_ga191b27bec42ab0370248fbc64cc9b860"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#ga191b27bec42ab0370248fbc64cc9b860">MSG_TYPE_FED_NONCE</a>&#160;&#160;&#160;100</td></tr>
<tr class="memdesc:ga191b27bec42ab0370248fbc64cc9b860"><td class="mdescLeft">&#160;</td><td class="mdescRight">Byte identifying a message from a federate to an RTI containing federate's 8-byte random nonce for HMAC-based authentication.  <br /></td></tr>
<tr class="memitem:gacd7e1e07253e568044a204a1f82d36a1" id="r_gacd7e1e07253e568044a204a1f82d36a1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#gacd7e1e07253e568044a204a1f82d36a1">MSG_TYPE_FED_RESPONSE</a>&#160;&#160;&#160;102</td></tr>
<tr class="memdesc:gacd7e1e07253e568044a204a1f82d36a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Byte identifying a message from federate to RTI as a response to the RTI_RESPONSE message.  <br /></td></tr>
<tr class="memitem:gada47c9f6736992a3df380526d87089f9" id="r_gada47c9f6736992a3df380526d87089f9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#gada47c9f6736992a3df380526d87089f9">MSG_TYPE_LATEST_TAG_CONFIRMED</a>&#160;&#160;&#160;9</td></tr>
<tr class="memdesc:gada47c9f6736992a3df380526d87089f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Byte identifying a latest tag confirmed (LTC) message sent by a federate to the RTI.  <br /></td></tr>
<tr class="memitem:gac79b5228f132029285408a30a31a174e" id="r_gac79b5228f132029285408a30a31a174e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#gac79b5228f132029285408a30a31a174e">MSG_TYPE_MESSAGE</a>&#160;&#160;&#160;3</td></tr>
<tr class="memdesc:gac79b5228f132029285408a30a31a174e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Byte identifying a message to forward to another federate.  <br /></td></tr>
<tr class="memitem:ga48ec489cb1543b161c262f4bee6c9598" id="r_ga48ec489cb1543b161c262f4bee6c9598"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#ga48ec489cb1543b161c262f4bee6c9598">MSG_TYPE_NEIGHBOR_STRUCTURE</a>&#160;&#160;&#160;24</td></tr>
<tr class="memdesc:ga48ec489cb1543b161c262f4bee6c9598"><td class="mdescLeft">&#160;</td><td class="mdescRight">A message that informs the RTI about connections between this federate and other federates where messages are routed through the RTI.  <br /></td></tr>
<tr class="memitem:ga77a9c1b741d7ca0f4e8d00a5b74ef91e" id="r_ga77a9c1b741d7ca0f4e8d00a5b74ef91e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#ga77a9c1b741d7ca0f4e8d00a5b74ef91e">MSG_TYPE_NEIGHBOR_STRUCTURE_HEADER_SIZE</a>&#160;&#160;&#160;9</td></tr>
<tr class="memdesc:ga77a9c1b741d7ca0f4e8d00a5b74ef91e"><td class="mdescLeft">&#160;</td><td class="mdescRight">The size of the header of a neighbor structure message.  <br /></td></tr>
<tr class="memitem:gaf662a6a84cd64cddad92e20e26af877e" id="r_gaf662a6a84cd64cddad92e20e26af877e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#gaf662a6a84cd64cddad92e20e26af877e">MSG_TYPE_NEXT_EVENT_TAG</a>&#160;&#160;&#160;6</td></tr>
<tr class="memdesc:gaf662a6a84cd64cddad92e20e26af877e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Byte identifying a next event tag (NET) message sent from a federate in centralized coordination.  <br /></td></tr>
<tr class="memitem:ga2b9f13f8df66448bf81ac5fe0774c124" id="r_ga2b9f13f8df66448bf81ac5fe0774c124"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#ga2b9f13f8df66448bf81ac5fe0774c124">MSG_TYPE_P2P_MESSAGE</a>&#160;&#160;&#160;17</td></tr>
<tr class="memdesc:ga2b9f13f8df66448bf81ac5fe0774c124"><td class="mdescLeft">&#160;</td><td class="mdescRight">Byte identifying a message to send directly to another federate.  <br /></td></tr>
<tr class="memitem:gacd33bbab7bf74e5ac8bad3bd27145f8b" id="r_gacd33bbab7bf74e5ac8bad3bd27145f8b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#gacd33bbab7bf74e5ac8bad3bd27145f8b">MSG_TYPE_P2P_SENDING_FED_ID</a>&#160;&#160;&#160;16</td></tr>
<tr class="memdesc:gacd33bbab7bf74e5ac8bad3bd27145f8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Byte identifying a first message that is sent by a federate directly to another federate after establishing a socket connection to send messages directly to the federate.  <br /></td></tr>
<tr class="memitem:ga5c1256c8c62fbbcb1b16ea67d8f529fb" id="r_ga5c1256c8c62fbbcb1b16ea67d8f529fb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#ga5c1256c8c62fbbcb1b16ea67d8f529fb">MSG_TYPE_P2P_TAGGED_MESSAGE</a>&#160;&#160;&#160;18</td></tr>
<tr class="memdesc:ga5c1256c8c62fbbcb1b16ea67d8f529fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Byte identifying a timestamped message to send directly to another federate.  <br /></td></tr>
<tr class="memitem:gadb9610b1edbee4c85e194e391a6eeb74" id="r_gadb9610b1edbee4c85e194e391a6eeb74"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#gadb9610b1edbee4c85e194e391a6eeb74">MSG_TYPE_PORT_ABSENT</a>&#160;&#160;&#160;23</td></tr>
<tr class="memdesc:gadb9610b1edbee4c85e194e391a6eeb74"><td class="mdescLeft">&#160;</td><td class="mdescRight">A port absent message, informing the receiver that a given port will not have event for the current logical time.  <br /></td></tr>
<tr class="memitem:ga9a9bb60d4df1ba581a29319850097cc2" id="r_ga9a9bb60d4df1ba581a29319850097cc2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#ga9a9bb60d4df1ba581a29319850097cc2">MSG_TYPE_PROVISIONAL_TAG_ADVANCE_GRANT</a>&#160;&#160;&#160;8</td></tr>
<tr class="memdesc:ga9a9bb60d4df1ba581a29319850097cc2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Byte identifying a provisional time advance grant (PTAG) sent by the RTI to a federate in centralized coordination.  <br /></td></tr>
<tr class="memitem:ga59a69d0685fdc2a216718f1efa083c4c" id="r_ga59a69d0685fdc2a216718f1efa083c4c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#ga59a69d0685fdc2a216718f1efa083c4c">MSG_TYPE_REJECT</a>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:ga59a69d0685fdc2a216718f1efa083c4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Byte identifying a rejection of the previously received message.  <br /></td></tr>
<tr class="memitem:ga9e19e307a4c3a9dbccea4f2539cd67dd" id="r_ga9e19e307a4c3a9dbccea4f2539cd67dd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#ga9e19e307a4c3a9dbccea4f2539cd67dd">MSG_TYPE_RESIGN</a>&#160;&#160;&#160;4</td></tr>
<tr class="memdesc:ga9e19e307a4c3a9dbccea4f2539cd67dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Byte identifying that the federate or the RTI is ending its execution.  <br /></td></tr>
<tr class="memitem:ga20f24b4b20547d44523120689afd9b98" id="r_ga20f24b4b20547d44523120689afd9b98"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#ga20f24b4b20547d44523120689afd9b98">MSG_TYPE_RTI_RESPONSE</a>&#160;&#160;&#160;101</td></tr>
<tr class="memdesc:ga20f24b4b20547d44523120689afd9b98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Byte identifying a message from RTI to federate as a response to the FED_NONCE message.  <br /></td></tr>
<tr class="memitem:gaad37dd00423e88f213ca7d7d238bce2e" id="r_gaad37dd00423e88f213ca7d7d238bce2e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#gaad37dd00423e88f213ca7d7d238bce2e">MSG_TYPE_STOP_GRANTED</a>&#160;&#160;&#160;12</td></tr>
<tr class="memdesc:gaad37dd00423e88f213ca7d7d238bce2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Byte sent by the RTI indicating that the stop request from some federate has been granted.  <br /></td></tr>
<tr class="memitem:ga76275384e9865f1f1ed32408c03d876a" id="r_ga76275384e9865f1f1ed32408c03d876a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#ga76275384e9865f1f1ed32408c03d876a">MSG_TYPE_STOP_GRANTED_LENGTH</a>&#160;&#160;&#160;(1 + sizeof(<a class="el" href="group__API.html#ga827080fd3c574bad5a32db9f7c367587">instant_t</a>) + sizeof(<a class="el" href="group__API.html#gad88f1caa8b9c216404eb196cb1850213">microstep_t</a>))</td></tr>
<tr class="memdesc:ga76275384e9865f1f1ed32408c03d876a"><td class="mdescLeft">&#160;</td><td class="mdescRight">The length of a stop granted message.  <br /></td></tr>
<tr class="memitem:a8588a57a3ae81bf33c740dfc57103a23" id="r_a8588a57a3ae81bf33c740dfc57103a23"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8588a57a3ae81bf33c740dfc57103a23">MSG_TYPE_STOP_REQUEST</a>&#160;&#160;&#160;10</td></tr>
<tr class="memdesc:a8588a57a3ae81bf33c740dfc57103a23"><td class="mdescLeft">&#160;</td><td class="mdescRight">Byte identifying a stop request.  <br /></td></tr>
<tr class="memitem:gaa3ed75054ae1aaa64dafa6399f7a23cb" id="r_gaa3ed75054ae1aaa64dafa6399f7a23cb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#gaa3ed75054ae1aaa64dafa6399f7a23cb">MSG_TYPE_STOP_REQUEST_LENGTH</a>&#160;&#160;&#160;(1 + sizeof(<a class="el" href="group__API.html#ga827080fd3c574bad5a32db9f7c367587">instant_t</a>) + sizeof(<a class="el" href="group__API.html#gad88f1caa8b9c216404eb196cb1850213">microstep_t</a>))</td></tr>
<tr class="memdesc:gaa3ed75054ae1aaa64dafa6399f7a23cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">The length of a stop request message.  <br /></td></tr>
<tr class="memitem:adbe10e103635ee7ec4bca3226ccebc56" id="r_adbe10e103635ee7ec4bca3226ccebc56"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adbe10e103635ee7ec4bca3226ccebc56">MSG_TYPE_STOP_REQUEST_REPLY</a>&#160;&#160;&#160;11</td></tr>
<tr class="memdesc:adbe10e103635ee7ec4bca3226ccebc56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Byte indicating a federate's reply to a MSG_TYPE_STOP_REQUEST that was sent by the RTI.  <br /></td></tr>
<tr class="memitem:gaa62d9986e928cb5e872caa6a509cae6c" id="r_gaa62d9986e928cb5e872caa6a509cae6c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#gaa62d9986e928cb5e872caa6a509cae6c">MSG_TYPE_STOP_REQUEST_REPLY_LENGTH</a>&#160;&#160;&#160;(1 + sizeof(<a class="el" href="group__API.html#ga827080fd3c574bad5a32db9f7c367587">instant_t</a>) + sizeof(<a class="el" href="group__API.html#gad88f1caa8b9c216404eb196cb1850213">microstep_t</a>))</td></tr>
<tr class="memdesc:gaa62d9986e928cb5e872caa6a509cae6c"><td class="mdescLeft">&#160;</td><td class="mdescRight">The length of a stop request reply message.  <br /></td></tr>
<tr class="memitem:ga94fe2c510160682b2c0ffc00b35e0ad5" id="r_ga94fe2c510160682b2c0ffc00b35e0ad5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#ga94fe2c510160682b2c0ffc00b35e0ad5">MSG_TYPE_TAG_ADVANCE_GRANT</a>&#160;&#160;&#160;7</td></tr>
<tr class="memdesc:ga94fe2c510160682b2c0ffc00b35e0ad5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Byte identifying a time advance grant (TAG) sent by the RTI to a federate in centralized coordination.  <br /></td></tr>
<tr class="memitem:ga2922af172f2e95bc73bd0675a4107b3b" id="r_ga2922af172f2e95bc73bd0675a4107b3b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#ga2922af172f2e95bc73bd0675a4107b3b">MSG_TYPE_TAGGED_MESSAGE</a>&#160;&#160;&#160;5</td></tr>
<tr class="memdesc:ga2922af172f2e95bc73bd0675a4107b3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Byte identifying a timestamped message to forward to another federate.  <br /></td></tr>
<tr class="memitem:ga27db349e7460afc1758bf2eec95d7005" id="r_ga27db349e7460afc1758bf2eec95d7005"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#ga27db349e7460afc1758bf2eec95d7005">MSG_TYPE_TIMESTAMP</a>&#160;&#160;&#160;2</td></tr>
<tr class="memdesc:ga27db349e7460afc1758bf2eec95d7005"><td class="mdescLeft">&#160;</td><td class="mdescRight">Byte identifying a timestamp message, which is 64 bits long.  <br /></td></tr>
<tr class="memitem:ga3450aedd1ca1c368ed28ed2e859588ef" id="r_ga3450aedd1ca1c368ed28ed2e859588ef"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#ga3450aedd1ca1c368ed28ed2e859588ef">MSG_TYPE_TIMESTAMP_LENGTH</a>&#160;&#160;&#160;(1 + sizeof(int64_t))</td></tr>
<tr class="memdesc:ga3450aedd1ca1c368ed28ed2e859588ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">The length of a timestamp message.  <br /></td></tr>
<tr class="memitem:gae2c2fdb5fbcc47750409348d37b0cd78" id="r_gae2c2fdb5fbcc47750409348d37b0cd78"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#gae2c2fdb5fbcc47750409348d37b0cd78">MSG_TYPE_UDP_PORT</a>&#160;&#160;&#160;254</td></tr>
<tr class="memdesc:gae2c2fdb5fbcc47750409348d37b0cd78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Byte identifying an acknowledgment of the previously received MSG_TYPE_FED_IDS message.  <br /></td></tr>
<tr class="memitem:ga6771c37605e49c8faae7898797f254b7" id="r_ga6771c37605e49c8faae7898797f254b7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#ga6771c37605e49c8faae7898797f254b7">NONCE_LENGTH</a>&#160;&#160;&#160;8</td></tr>
<tr class="memdesc:ga6771c37605e49c8faae7898797f254b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">The randomly created nonce size will be 8 bytes.  <br /></td></tr>
<tr class="memitem:gae546b6c6176fe607616181e144364f2b" id="r_gae546b6c6176fe607616181e144364f2b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#gae546b6c6176fe607616181e144364f2b">RTI_NOT_EXECUTED_WITH_AUTH</a>&#160;&#160;&#160;7</td></tr>
<tr class="memdesc:gae546b6c6176fe607616181e144364f2b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Code sent with a <a class="el" href="group__Federated.html#ga59a69d0685fdc2a216718f1efa083c4c">MSG_TYPE_REJECT</a> message indicating that the RTI was not executed using the -a or &ndash;auth option.  <br /></td></tr>
<tr class="memitem:gabd435507a255ff2571133013bdf93bd2" id="r_gabd435507a255ff2571133013bdf93bd2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#gabd435507a255ff2571133013bdf93bd2">SHA256_HMAC_LENGTH</a>&#160;&#160;&#160;32</td></tr>
<tr class="memdesc:gabd435507a255ff2571133013bdf93bd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">The HMAC tag uses the SHA256 hash algorithm, creating a 32 byte length hash tag.  <br /></td></tr>
<tr class="memitem:gae2e1a44a10d4219f4645a4e99fee009c" id="r_gae2e1a44a10d4219f4645a4e99fee009c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#gae2e1a44a10d4219f4645a4e99fee009c">UNEXPECTED_MESSAGE</a>&#160;&#160;&#160;4</td></tr>
<tr class="memdesc:gae2e1a44a10d4219f4645a4e99fee009c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Code sent with a <a class="el" href="group__Federated.html#ga59a69d0685fdc2a216718f1efa083c4c">MSG_TYPE_REJECT</a> message indicating that the incoming message is not expected.  <br /></td></tr>
<tr class="memitem:ga5a6c87886a0136b58ae5bb1d627c7ae3" id="r_ga5a6c87886a0136b58ae5bb1d627c7ae3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Federated.html#ga5a6c87886a0136b58ae5bb1d627c7ae3">WRONG_SERVER</a>&#160;&#160;&#160;5</td></tr>
<tr class="memdesc:ga5a6c87886a0136b58ae5bb1d627c7ae3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Code sent with a <a class="el" href="group__Federated.html#ga59a69d0685fdc2a216718f1efa083c4c">MSG_TYPE_REJECT</a> message indicating that the connected to the wrong server.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Common message types and definitions for federated Lingua Franca programs. </p>
<dl class="section author"><dt>Author</dt><dd>Edward A. Lee </dd>
<dd>
Soroush Bateni</dd></dl>
<p>This file defines the message types for the federate to communicate with the RTI. Each message type has a unique one-byte ID.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md11"></a>
Startup sequence</h2>
<p>The startup sequence is as follows:</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md12"></a>
Establishing a TCP connection</h3>
<p>Each federate attempts to connect with an RTI at the IP address put into its code by the code generator (i.e., it attempts to open a TCP connection). If an explicit port is given in the <span class="tt">at</span> clause on the <span class="tt">federated reactor</span> statement, it will use that port. Otherwise, it will use DEFAULT_PORT.</p>
<p>When it has successfully opened a TCP connection, the first message it sends to the RTI is a <a class="el" href="group__Federated.html#ga8e49ce0b1c3a58c881849ca4d0bae824">MSG_TYPE_FED_IDS</a> message, which contains the ID of this federate within the federation, contained in the global variable _lf_my_fed_id in the federate code (which is initialized by the code generator) and the unique ID of the federation, a GUID that is created at run time by the generated script that launches the federation. If you launch the federates and the RTI manually, rather than using the script, then the federation ID is a string that is optionally given to the federate on the command line when it is launched. The federate will connect successfully only to an RTI that is given the same federation ID on its command line. If no ID is given on the command line, then the default ID "Unidentified Federation" will be used.</p>
<p>The RTI will respond with a <a class="el" href="group__Federated.html#ga59a69d0685fdc2a216718f1efa083c4c">MSG_TYPE_REJECT</a> message if the federation IDs do not match and close the connection. At this point the federate will increment the port number and try again to find an RTI that matches.</p>
<p>When the federation IDs match, the RTI will respond with an MSG_TYPE_ACK.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md13"></a>
Conveying the neighbor structure</h3>
<p>The next message to the RTI will be a <a class="el" href="group__Federated.html#ga48ec489cb1543b161c262f4bee6c9598">MSG_TYPE_NEIGHBOR_STRUCTURE</a> message that informs the RTI about connections between this federate and other federates where messages are routed through the RTI. Currently, this only includes logical connections when the coordination is centralized. This information is needed for the RTI to perform the centralized coordination. The burden is on the federates to inform the RTI about relevant connections.</p>
<p>The next message to the RTI will be a <a class="el" href="group__Federated.html#gae2c2fdb5fbcc47750409348d37b0cd78">MSG_TYPE_UDP_PORT</a> message, which has payload USHRT_MAX if clock synchronization is disabled altogether, 0 if only initial clock synchronization is enabled, and a port number for UDP communication if runtime clock synchronization is enabled. By default, if the federate host is identical to that of the RTI (either no "at" clause is given for either or they both have exactly the same string), then clock synchronization is disabled. Otherwise, the default is that initial clock synchronization is enabled. To turn turn off clock synchronization altogether, set the clock-sync property of the target to off. To turn on runtime clock synchronization, set it to on. The default value is initial.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md14"></a>
Clock synchronization</h3>
<p>If initial clock sync is enabled, the next step is to perform the initial clock synchronization (using the TCP connection), which attempts to find an initial offset to the physical clock of the federate to make it better match the physical clock at the RTI.</p>
<p>Clock synchronization is initiated by the RTI by sending a message of type <a class="el" href="group__Federated.html#gaea37eff76ade1b2781a7e6298afb3a04">MSG_TYPE_CLOCK_SYNC_T1</a>, the payload of which is the current physical clock reading at the RTI. The federate records the physical time when it receives this message (T2) and sends a reply message of type <a class="el" href="group__Federated.html#ga52a76e4cc36217a169f32d5adde590cc">MSG_TYPE_CLOCK_SYNC_T3</a> to the RTI. It records the time (T3) at which this message has gone out. The payload of the <a class="el" href="group__Federated.html#ga52a76e4cc36217a169f32d5adde590cc">MSG_TYPE_CLOCK_SYNC_T3</a> message is the federate ID. The RTI responds to the T3 message with a message of type <a class="el" href="group__Federated.html#gae128056ab2af39988103856ee815d930">MSG_TYPE_CLOCK_SYNC_T4</a>, which has as a payload the physical time at which that response was sent. This cycle will happen _LF_CLOCK_SYNC_EXCHANGES_PER_INTERVAL times at startup to account for network delay variations (see below).</p>
<p>The times T1 and T4 are taken from the physical clock at the RTI, whereas the times T2 and T3 are taken from the physical clock at the federate. The round trip latency on the connection to the RTI is therefore measured as (T4 - T1) - (T3 - T2). Half this quantity is an estimate L of the one-way latency. The estimated clock error E is therefore L - (T2 - T1). Over several cycles, the average value of E becomes the initial offset for the clock at the federate. Henceforth, when <a class="el" href="group__API.html#ga7538766a655ba2e60ddde55f2e020e58" title="Return the current physical time in nanoseconds.">lf_time_physical()</a> is called, the offset will be added to whatever the physical clock says.</p>
<p>If clock synchronization is enabled, then the federate will also start a thread to listen for incoming UDP messages from the RTI. With period given by the <span class="tt">-c on period &lt;n&gt;</span> command-line argument, the RTI will initiate a clock synchronization round by sending to the federate a <a class="el" href="group__Federated.html#gaea37eff76ade1b2781a7e6298afb3a04">MSG_TYPE_CLOCK_SYNC_T1</a> message. A similar protocol to that above is followed to estimate the average clock synchronization error E, with two exceptions. First, a fraction of E (given by _LF_CLOCK_SYNC_ATTENUATION) is used to adjust the offset up or down rather than just setting the offset equal to E. Second, after MSG_TYPE_CLOCK_SYNC_T4, the RTI immediately sends a following message of type MSG_TYPE_CLOCK_SYNC_CODED_PROBE. The federate measures the time difference between its receipt of T4 and this code probe and compares that time difference against the time difference at the RTI (the difference between the two payloads). If that difference is larger than CLOCK_SYNC_GUARD_BAND in magnitude, then the clock synchronization round is skipped and no adjustment is made. The round will also be skipped if any of the expected UDP messages fails to arrive.</p>
<p>See: Geng, Y., et al. (2018). Exploiting a Natural Network Effect for Scalable, Fine-grained Clock Synchronization. USENIX Symposium on Networked Systems Design and Implementation (NSDI), Renton, WA, USA.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md15"></a>
Setting up coordination</h3>
<p>The next step depends on the coordination mode. If the coordination parameter of the target is "decentralized" and the federate has inbound connections from other federates, then it starts a socket server to listen for incoming connections from those federates. It then sends to the RTI an MSG_TYPE_ADDRESS_ADVERTISEMENT message with the port number as a payload. The federate then creates a thread to listen for incoming socket connections and messages.</p>
<p>If the federate has outbound connections to other federates, then it establishes a socket connection to those federates. It does this by first sending to the RTI an <a class="el" href="group__Federated.html#ga5ac191bca25da16eca3e4f02d21172ef">MSG_TYPE_ADDRESS_QUERY</a> message with the payload being the ID of the federate it wishes to connect to. If the RTI responds with a -1, then the RTI does not (yet) know the remote federate's port number and IP address, so the local federate will try again after waiting ADDRESS_QUERY_RETRY_INTERVAL. When it gets a valid port number and IP address in reply, it will establish a socket connection to that remote federate.</p>
<p>Physical connections also use the above P2P sockets between federates even if the coordination is centralized.</p>
<p>Afterward, the federates and the RTI decide on a common start time by having each federate report a reading of its physical clock to the RTI on a <span class="tt">MSG_TYPE_TIMESTAMP</span>. The RTI broadcasts the maximum of these readings plus <span class="tt">DELAY_START</span> to all federates as the start time, again on a <span class="tt">MSG_TYPE_TIMESTAMP</span>.</p>
<p>The next step depends on the coordination type.</p>
<p>Under centralized coordination, each federate will send a <span class="tt">MSG_TYPE_NEXT_EVENT_TAG</span> to the RTI with the start tag. That is to say that each federate has a valid event at the start tag (start time, 0) and it will inform the RTI of this event. Subsequently, at the conclusion of each tag, each federate will send a <span class="tt">MSG_TYPE_LATEST_TAG_CONFIRMED</span> followed by a <span class="tt">MSG_TYPE_NEXT_EVENT_TAG</span> (see the comment for each message for further explanation). Each federate would have to wait for a <span class="tt">MSG_TYPE_TAG_ADVANCE_GRANT</span> or a <span class="tt">MSG_TYPE_PROVISIONAL_TAG_ADVANCE_GRANT</span> before it can advance to a particular tag.</p>
<p>Under decentralized coordination, the coordination is governed by STA and STAAs, as further explained in <a href="https://doi.org/10.48550/arXiv.2109.07771">https://doi.org/10.48550/arXiv.2109.07771</a>.</p>
<p>FIXME: Expand this. Explain port absent reactions.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md16"></a>
Requesting a stop</h3>
<p>Overview of the algorithm: When any federate calls <a class="el" href="group__API.html#gab49affc958f705d9e33c5e3463848bda" title="Request a stop to execution as soon as possible.">lf_request_stop()</a>, it will send a MSG_TYPE_STOP_REQUEST message to the RTI, which will then forward a MSG_TYPE_STOP_REQUEST message to any federate that has not yet provided a stop time to the RTI. The federates will reply with a MSG_TYPE_STOP_REQUEST_REPLY and a stop tag (which shall be the maximum of their current logical tag at the time they receive the MSG_TYPE_STOP_REQUEST and the tag of the stop request). When the RTI has gathered all the stop tags from federates (that are still connected), it will decide on a common stop tag which is the maximum of the seen stop tag and answer with a MSG_TYPE_STOP_GRANTED. The federate sending the MSG_TYPE_STOP_REQUEST and federates sending the MSG_TYPE_STOP_REQUEST_REPLY will freeze the advancement of tag until they receive the MSG_TYPE_STOP_GRANTED message, in which case they might continue their execution until the stop tag has been reached. </p>
</div><a name="doc-define-members" id="doc-define-members"></a><h2 id="header-doc-define-members" class="groupheader">Macro Definition Documentation</h2>
<a id="a8588a57a3ae81bf33c740dfc57103a23" name="a8588a57a3ae81bf33c740dfc57103a23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8588a57a3ae81bf33c740dfc57103a23">&#9670;&#160;</a></span>MSG_TYPE_STOP_REQUEST</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MSG_TYPE_STOP_REQUEST&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Byte identifying a stop request. </p>
<p>This message is first sent to the RTI by a federate that would like to stop execution at the specified tag. The RTI will forward the MSG_TYPE_STOP_REQUEST to all other federates. Those federates will either agree to the requested tag or propose a larger tag. The RTI will collect all proposed tags and broadcast the largest of those to all federates. All federates will then be expected to stop at the granted tag.</p>
<p>The next 8 bytes will be the timestamp. The next 4 bytes will be the microstep.</p>
<p>NOTE: The RTI may reply with a larger tag than the one specified in this message. It has to be that way because if any federate can send a MSG_TYPE_STOP_REQUEST message that specifies the stop time on all other federates, then every federate depends on every other federate and time cannot be advanced. Hence, the actual stop time may be nondeterministic.</p>
<p>If, on the other hand, the federate requesting the stop is upstream of every other federate, then it should be possible to respect its requested stop tag. </p>

</div>
</div>
<a id="adbe10e103635ee7ec4bca3226ccebc56" name="adbe10e103635ee7ec4bca3226ccebc56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbe10e103635ee7ec4bca3226ccebc56">&#9670;&#160;</a></span>MSG_TYPE_STOP_REQUEST_REPLY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MSG_TYPE_STOP_REQUEST_REPLY&#160;&#160;&#160;11</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Byte indicating a federate's reply to a MSG_TYPE_STOP_REQUEST that was sent by the RTI. </p>
<p>The payload is a proposed stop tag that is at least as large as the one sent to the federate in a MSG_TYPE_STOP_REQUEST message.</p>
<p>The next 8 bytes will be the timestamp. The next 4 bytes will be the microstep. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_d522931ffa1371640980b621734a4381.html">Users</a></li><li class="navelem"><a href="dir_308bc1499b5f97ed0ba0865f54916185.html">runner</a></li><li class="navelem"><a href="dir_61c33e2faf3f402353c3e4f8a1de3ade.html">work</a></li><li class="navelem"><a href="dir_f3821db21fac557b6b84e126be960f00.html">reactor-c</a></li><li class="navelem"><a href="dir_ac1783de82f42168f79d5e66bc78eb8b.html">reactor-c</a></li><li class="navelem"><a href="dir_c9cd8ac8edbc816f956bbae22744abc5.html">include</a></li><li class="navelem"><a href="dir_26ddd9272df60b6031e319f70270bd7f.html">core</a></li><li class="navelem"><a href="dir_e0b79ab85e892bf9453f746580791e50.html">federated</a></li><li class="navelem"><a href="dir_923a8cfe9e7422391fb9e4b64cd33eea.html">network</a></li><li class="navelem"><a href="net__common_8h.html">net_common.h</a></li>
    <li class="footer">Generated on <span class="timestamp"></span> for reactor-c by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
